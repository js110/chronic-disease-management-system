# 慢性病管理系统开发指南

## 快速启动

### 一键启动（推荐）

**Windows 用户**
双击运行 `quick-start.bat` 文件，或在命令行中执行：
```cmd
quick-start.bat
```

**Linux/Mac 用户**
```bash
# 手动启动后端
cd backend
npm install
npm run init-db
npm run init-demo
npm start

# 新开终端启动前端
cd frontend
npm install
npm run dev
```

### 演示数据说明
系统会自动初始化丰富的演示数据：
- 6名患者的完整信息
- 8条慢性病病历记录  
- 200+条健康指标数据
- 10条用药记录
- 完整的统计报表数据

### 手动启动
如果自动脚本无法运行，可以手动启动：

1. **安装后端依赖并启动**
```bash
cd backend
npm install
npm run init-db
npm run dev
```

2. **安装前端依赖并启动**（新开一个终端）
```bash
cd frontend
npm install
npm run serve
```

## 系统访问

- **前端界面**: http://localhost:8080
- **后端API**: http://localhost:3000
- **默认管理员账号**: admin / admin123

## 已实现功能

### 🔐 用户认证系统
- JWT令牌认证
- 角色权限管理（admin、doctor、patient）
- 安全的密码加密存储

### 👥 患者管理
- 患者信息的完整CRUD操作
- 患者搜索和筛选
- 患者详情页面
- 医疗信息管理（病史、过敏史）

### 📋 病历管理
- 慢性病档案管理
- 疾病类型管理
- 病历状态跟踪
- 诊断记录

### 📊 健康指标监测
- 多种健康指标记录（血压、血糖、体重等）
- 按患者和时间筛选
- 统计分析功能
- 图表展示（待完善）

### 👨‍⚕️ 医生管理
- 医生信息管理
- 科室和专业设置
- 权限控制

## 数据库结构

系统使用SQLite数据库，包含以下主要表：

- `patients` - 患者信息
- `doctors` - 医生信息  
- `users` - 系统用户
- `chronic_disease_types` - 慢性病类型
- `medical_records` - 病历记录
- `health_indicators` - 健康指标
- `medications` - 用药记录（待实现）

## API接口文档

### 认证接口
- `POST /api/auth/login` - 用户登录
- `POST /api/auth/register` - 用户注册
- `GET /api/auth/me` - 获取当前用户信息

### 患者管理
- `GET /api/patients` - 获取患者列表
- `POST /api/patients` - 创建患者
- `GET /api/patients/:id` - 获取患者详情
- `PUT /api/patients/:id` - 更新患者信息
- `DELETE /api/patients/:id` - 删除患者

### 病历管理
- `GET /api/medical-records` - 获取病历列表
- `POST /api/medical-records` - 创建病历
- `GET /api/medical-records/:id` - 获取病历详情
- `PUT /api/medical-records/:id` - 更新病历
- `DELETE /api/medical-records/:id` - 删除病历

### 健康指标
- `GET /api/health-indicators` - 获取健康指标列表
- `POST /api/health-indicators` - 创建健康指标
- `GET /api/health-indicators/patient/:patientId` - 按患者查询
- `GET /api/health-indicators/patient/:patientId/stats` - 获取统计信息

### 疾病类型
- `GET /api/disease-types` - 获取疾病类型列表
- `POST /api/disease-types` - 创建疾病类型（仅管理员）

## 开发环境配置

### 后端环境变量 (.env)
```env
PORT=3000
NODE_ENV=development
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=7d
DB_PATH=./db/chronic_disease.db
UPLOAD_PATH=./uploads
```

### 前端配置
- Vue 3 + Composition API
- Element Plus UI组件库
- Vue Router 4
- Axios HTTP客户端

## 下一步开发计划

### 高优先级功能
1. **用药管理模块**
   - 用药记录CRUD
   - 用药提醒功能
   - 药物相互作用检查

2. **数据可视化增强**
   - 集成ECharts图表库
   - 健康指标趋势图
   - 统计报表

3. **文件上传功能**
   - 医疗文档上传
   - 图片查看器
   - 文件管理

### 中优先级功能
1. **消息通知系统**
   - 系统消息
   - 邮件通知
   - 提醒功能

2. **数据导入导出**
   - Excel导入患者数据
   - 报告导出功能
   - 数据备份

3. **系统设置**
   - 参数配置
   - 用户权限细化
   - 系统日志

### 技术优化
1. **代码质量**
   - 添加单元测试
   - ESLint配置
   - TypeScript支持

2. **性能优化**
   - 路由懒加载
   - 数据库查询优化
   - 缓存机制

3. **安全加固**
   - 输入验证
   - SQL注入防护
   - XSS防护

## 常见问题

### Q: 如何重置管理员密码？
A: 删除数据库文件 `backend/db/chronic_disease.db`，重新运行 `npm run init-db`

### Q: 如何添加新的健康指标类型？
A: 在前端 `HealthIndicators.vue` 中的指标类型选项中添加，后端会自动支持

### Q: 如何修改端口？
A: 修改 `backend/.env` 文件中的 `PORT` 变量，前端在 `package.json` 中修改 serve 脚本

### Q: 数据库文件在哪里？
A: SQLite数据库文件位于 `backend/db/chronic_disease.db`

## 贡献指南

1. Fork 项目
2. 创建功能分支
3. 提交代码
4. 创建 Pull Request

## 技术支持

如遇到问题，请检查：
1. Node.js版本 >= 14.0.0
2. npm版本 >= 6.0.0
3. 端口3000和8080是否被占用
4. 防火墙设置

---

**注意**: 这是一个开发版本，生产环境使用前请进行充分的安全配置和测试。