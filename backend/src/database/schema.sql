CREATE TABLE IF NOT EXISTS patients (id INTEGER PRIMARY KEY AUTOINCREMENT, patient_id TEXT UNIQUE NOT NULL, name TEXT NOT NULL, gender TEXT, birth_date DATE, phone TEXT, email TEXT, address TEXT, medical_history TEXT, allergies TEXT, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP); 
CREATE TABLE IF NOT EXISTS doctors (id INTEGER PRIMARY KEY AUTOINCREMENT, doctor_id TEXT UNIQUE NOT NULL, name TEXT NOT NULL, department TEXT, phone TEXT, email TEXT, specialty TEXT, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP); 
CREATE TABLE IF NOT EXISTS chronic_disease_types (id INTEGER PRIMARY KEY AUTOINCREMENT, disease_code TEXT UNIQUE NOT NULL, disease_name TEXT NOT NULL, description TEXT, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP); 
CREATE TABLE IF NOT EXISTS medical_records (id INTEGER PRIMARY KEY AUTOINCREMENT, patient_id INTEGER NOT NULL, disease_type_id INTEGER NOT NULL, diagnosis_date DATE, status TEXT DEFAULT 'active', notes TEXT, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (patient_id) REFERENCES patients(id), FOREIGN KEY (disease_type_id) REFERENCES chronic_disease_types(id)); 
CREATE TABLE IF NOT EXISTS health_indicators (id INTEGER PRIMARY KEY AUTOINCREMENT, record_id INTEGER NOT NULL, indicator_type TEXT NOT NULL, value REAL NOT NULL, unit TEXT, recorded_date DATE NOT NULL, notes TEXT, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (record_id) REFERENCES medical_records(id)); 
CREATE TABLE IF NOT EXISTS medications (id INTEGER PRIMARY KEY AUTOINCREMENT, record_id INTEGER NOT NULL, medication_name TEXT NOT NULL, dosage TEXT, frequency TEXT, start_date DATE, end_date DATE, notes TEXT, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, FOREIGN KEY (record_id) REFERENCES medical_records(id)); 
CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY AUTOINCREMENT, username TEXT UNIQUE NOT NULL, password_hash TEXT NOT NULL, role TEXT NOT NULL, associated_id INTEGER, created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP, updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP); 
CREATE TABLE IF NOT EXISTS data_exports (id INTEGER PRIMARY KEY AUTOINCREMENT, export_type TEXT NOT NULL, file_path TEXT NOT NULL, export_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP, exported_by INTEGER NOT NULL);